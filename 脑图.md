# H3CNE课程

01. 计算机网络概述
    - 计算机网络定义
        - 一组计算机互联的集合
    - 计算机网络基本功能
        - 资源共享
        - 综合信息服务
        - 分布式处理与负载均衡
    - 计算机网络类型
        - 局域网
            - LAN
            - 由用户自行建设,使用私有地址组件的网络
        - 城域网
            - MAN
            - 由运营商或大规模企业建设,连接城市范围的网络
        - 广域网
            - WAN
            - 由运营商建设,连接全国各个城域网的网络
            - 又称骨干网,核心网,传输网
    - 网络拓扑
        - 定义
            - 网络设备连接排列的方式
        - 分类
            - 总线型拓扑
                - 所有线路共享一条公共线路
                - 线路中断会导致所有设备中断通信
            - 环型拓扑
                - 将所有设备共享一条环型总线
                - 有了一定冗余
            - 星型拓扑
                - 其他节点都与中央节点直接相连
                - 优点
                    - 某条线路中断不会影响其他节点
                - 缺点
                    - 中央节点故障会导致全网中断
            - 树型拓扑
                - 星型拓扑的进一步发散型
                - 优点
                    - 结构简单,组网成本低,维护管理容易
                - 缺点
                    - 中央节点压力大,可靠性差
            - 网状拓扑
                - 节点之间有多条线路可达
                - 优点
                    - 可靠性高
                - 缺点
                    - 组网成本高,维护管理复杂
    - 衡量网络性能的指标
        - 带宽
            - 定义
                - 单位时间内能够传输的数据总量
                - 单位:bps
            - 带宽越大网络质量约好
        - 延迟
            - 定义
                - 数据从一个节点到达另一个节点消耗的时间
                - 单位:ms
            - 延迟越低,网络质量越好
    - 数据单位
        - 1Kb=1024b
        - 1Mb=1024Kb
        - 1Gb=1024Mb
        - Byte:字节,1个数字或字母占用1个字节,1个汉字占用2个字节
        - bit:比特,1Byte=8bit
    - 协议和标准
        - 协议
            - 数据通讯双方共同遵守的通讯规则
        - 标准
            - 公认的,所有厂商所共同遵守的协议规则
        - 标准化组织
            - 制定定义国际公认参考标准的组织团体
            - 常见国际标准组织
                - ISO
                    - 国际标准化组织
                - IEEE
                    - 电子电器工程师协会
02. 网络参考模型
    - OSI参考模型
        - 生产背景
            - 各大IT设备厂商只支持自己的私有协议,跨厂商设备兼容性差
            - 用户购买和维护成本高
            - 不利于网络技术发展
        - 概念
            - 定义了网络中的设备所遵守的层次结构
        - 优点
            - 开放的标准化接口,协议不再封闭
            - 多厂商设备兼容
            - 易于理解,学习和更新协议标准
            - 实现模块化工程,降低开发难度
            - 便于故障排除
        - 分层
            - 1.物理层
                - 定义电压,接口,线缆标准,传输距离,传输介质等物理参数
            - 2.数据链路层
                - Mac地址寻址
            - 3.网络层
                - 网络地址层寻址,路由
            - 4.传输层
                - 数据分段,建立端到端连接,维护传输可靠性
                - TCP
                    - 可靠的传输
                - UDP
                    - 不可靠的传输
            - 5.会话层
                - 建立,维护,拆除应用程序间的会话
            - 6.表示层
                - 定义数据格式,结构;数据加密,压缩
            - 7.应用层
                - 为应用程序进程提供网络服务
        - OSI参考模型的问题
            - 划分层次过多,会话层,表示层存在意义不大
            - IP协议成为事实上的网络唯一协议
    - TCP/IP参考模型
        - 4层划分方法
            - 1.网络接口层
                - 物理层
                - 数据链路层
            - 2.网络层
            - 3.传输层
            - 4.应用层
                - 会话层
                - 表示层
                - 应用层
        - 5层划分方法
            - 1.物理层
            - 2.数据链路层
            - 3.网络层
            - 4.传输层
            - 5.应用层
                - 会话层
                - 表示层
                - 应用层
    - 数据封装和解封
        - 定义
            - 封装
                - 在原始数据的基础上加入一些额外信息形成新的格式
            - 解封装
                - 拆除掉封装的额外信息,还原成原始数据
        - TCP/IP分层封装
            - 1.物理层:比特流
            - 2.数据链路层:数据帧
            - 3.网络层:数据包
            - 4.传输层:数据段
            - 5.应用层:数据
        - 数据封装和解封过程
            - 数据发送时,从上至下逐层封装
            - 数据接收时,从下至上逐层解封装
            - 只有拆除外层封装,才能看到内层封装
03. 局域网基本原理
    - 使用协议及线缆
        - 物理层
            - 双绞线
            - 同轴电缆
            - 光纤
            - 无线电
        - 数据链路层
            - 以太网
                - 目前唯一事实标准
            - 令牌环
                - 淘汰
            - FDDI(光纤分布式接口)
                - 淘汰
        - 网络层
            - IP
                - 目前唯一事实标准
            - IPX
                - 淘汰
            - Apple talk
                - 淘汰
    - 局域网设备
        - 集线器
            - 淘汰
            - 内部为总线型拓扑
            - 任意时间只能由一台主机占用总线,连接的所有设备位于同一冲突域
            - 工作在物理层,没有寻址能力,所有数据泛洪式转发
        - 交换机
            - 内部每两个接口都有一条独立线路.每个接口都是独立的冲突域
            - 工作在数据链路层,基于Mac地址寻址,数据可单点转发
        - 冲突域
            - 设备发送数据会产生冲突的网络范围
            - 集线器的所有接口在同一个冲突域
            - 交换机的每个接口都是一个独立的冲突域
        - CSMA/CD
            - 带冲突检测的载波侦听多路访问
    - 局域网线缆
        - 双绞线
            - 线型
                - 直连线
                    - 异类直连
                    - 两端线序一致
                - 交叉线
                    - 同类交叉
                    - 两端线序不一致
            - 线序
                - T568A
                    - 白绿,绿,白橙,蓝,白蓝,橙,白棕,棕
                - T568B
                    - 白橙,橙,白绿,蓝,白蓝,绿,白棕,棕
                - 1,2,3,6号线芯工作,其他为屏蔽线,1,3发送,2,6接收
            - 接口类型
                - RJ-45
                    - 8芯水晶头
                - RJ-11
                    - 4芯水晶头
        - 光纤
            - 多模光纤
                - 纤芯较粗,可传递多种光源
                - 传输距离短
                - 成本低
            - 单模光纤
                - 纤芯较细,只能传递单一光源
                - 传输距离远
                - 成本高
04. 广域网基本原理
    - 使用的协议及线缆
        - 物理层
            - 串行线缆
                - 淘汰
            - 光纤
                - EPON
        - 数据链路层
            - PPP(点到点)
                - 淘汰
            - HDLC
                - 淘汰
            - 帧中继(点到多点)
                - 淘汰
            - 以太网
                - 目前唯一事实标准
        - 网络层
            - IP
                - 目前唯一事实标准
    - 连接方式
        - 电路交换
            - PSTN(56k电话线拨号上网)
            - ISDN(128k电话线拨号上网)
                - 淘汰
        - 分组交换
            - 淘汰
        - ADSL
        - EPON
05. IP基本原理
    - IP的定义
        - 当前唯一的网络层协议标准
        - 定义数据网络层的封装方式,编址方法
    - MTU
        - 最大传输单元
        - 接口收发数据支持的单个包的最大长度
        - 以太网接口默认MTU:1500 Byte
        - PPPoE默认MTU:1492 Byte
    - IP头部封装格式
        - 长度在20至60 Byte
        - IP协议包的头部信息
            - Version
                - 版本号
                    - 只有2个IP协议版本
                    - IPv4
                    - IPv6
                - 长度:4 bit
            - Header Length
                - 包头部长度
                    - 记录整个头部信息的长度,单位Byte
                - 长度:4 bit
            - Type of Service
                - 服务类型
                    - 记录包传输的优先级
                    - QoS
                - 长度:8 bit
            - Total Length
                - 包长度
                    - 记录整个IP包的长度
                    - 用来计算数据的起始和结束位置
                - 长度:16 bit
            - Identifier
                - 标识符
                    - 包分片后的标识符
                    - 同一个包的不同分片标识符相同
                - 长度:16 bit
            - Flag
                - 置位符开关
                    - 标记是否允许分片
                    - 标记是否是最后一个分片
                - 长度:3 bit
            - Fragmented Offset
                - 偏移量
                    - 记录分片的顺序
                    - 包分片后按不同顺序到达目的地
                    - 包根据分片的偏移量重新组包
                - 长度:13 bit
            - Time to Live
                - 生存时间
                    - TTL
                    - 记录包可以经过的最大路由器个数
                    - 每经过一个路由器该值减1
                    - 到0还未到达目的地则抛弃该包
                    - 抛弃后发送ICMP消息通知源地址
                    - 防止路由死循环
                - 长度:8 bit
            - Protocal
                - 协议
                    - 记录上层传输层的协议类型
                    - 1:ICMP
                    - 2:IGMP
                    - 6:TCP
                    - 17:UDP
                - 长度:8 bit
            - Header CheckSum
                - 头部校验序列
                    - 记录包的头部校验信息
                    - 判断包的头部是否正确传输
                - 长度:16 bit
            - Source Address
                - 源地址
                    - 请求方IP地址
                - 长度:32 bit
            - Distination Address
                - 目的地址
                    - 响应方IP地址
                - 长度:32 bit
            - Options
                - 可选信息
                - 长度:最多40 Byte
            - Padding
                - 填充信息
    - IP地址
        - 定义
            - 网络层地址
        - 格式
            - 长度:32 bit
            - 每8 bit为一组,共4组
            - 由网络位+主机位组成
            - 网络位长度和数字完全一致的地址属于同一网段
            - 通常记做用点分割的十进制
            - 例:192.168.1.1
        - 分类
            - A类
                - 地址范围
                    - 1.X.X.X-126.X.X.X
                - 网络位划分
                    - 前8位为网络位,后24位为主机位
            - B类
                - 地址范围
                    - 128.X.X.X-191.X.X.X
                - 网络位划分
                    - 前16位为网络位,后16位为主机位
            - C类
                - 地址范围
                    - 192.X.X.X-223.X.X.X
                - 网络位划分
                    - 前24位为网络位,后8位为主机位
            - D类
                - 组播地址
                - 不能分配给主机
                - 地址范围
                    - 224.X.X.X-239.X.X.X
            - E类
                - 科研用地址
                - 不对公开放
                - 地址范围
                    - 240.X.X.X-255.X.X.X
            - IP地址分类用来划分不同的网络规模
        - 特殊地址
            - 127.X.X.X
                - 本地环回地址,用于标识本机
            - 主机位全0的地址
                - 网络地址,用于标识某个网段
            - 主机位全1的地址
                - 本网段广播地址
            - 255.255.255.255
                - 全网广播地址
            - 0.0.0.0
                - 任意IP地址
        - 公网/私网地址
            - 公网地址
                - 可以在互联网上寻址的地址,全球唯一,需要运营商分配
            - 私网地址
                - 本地随意使用,无法在互联网上寻址
                - 地址范围
                    - A类:10.X.X.X
                    - B类:172.16.X.X-172.31.X.X
                    - C类:192.168.X.X
                    - 运营商专用私有地址
                        - 100.64.X.X-100.128.X.X
    - ARP协议
        - 定义
            - 地址解析协议,把IP地址解析为Mac地址
        - 工作原理
            - A主机以广播形式发送ARP查询请求,询问B主机的IP对应的Mac地址
            - B主机以单播形式回复A主机本机Mac地址
            - A主机把B主机的IP地址和Mac地址的映射关系写入ARP缓存表
        - 相关命令
            - 查询ARP缓存
                - arp -a
            - 清空ARP缓存
                - arp -d
    - ICMP协议
        - Ping
            - 测试网络连通性
        - Tracert
            - 路由跟踪
            - H3C的设备开启路由跟踪功能需要的前置命令
                - ip ttl-expires enable
                - ip unreachables enable
    - IP数据转发原理
        - 如果目的IP和本机IP属于同一网段,会直接查询目的IP的Mac地址,并进行封装
        - 如果目的IP和本机IP不属于同一网段,会查询网关IP地址的Mac地址,并进行封装
    - 网关
        - Gateway
        - 本网段出口的IP地址
06. TCP/UDP原理
    - 端口
        - 每个应用程序进出网络都需要经过一个唯一端口,通过端口号来识别数据交由哪个应用程序处理
        - 服务端:固定端口号
        - 客户端:1024以上随机端口
        - 知名端口号
            - HTTP:TCP 80
            - FTP:TCP 20 21
            - TELNET:TCP 23
            - SMTP:TCP 25
            - DNS:UDP 53
    - TCP的原理
        - TCP头部封装格式
            - Source Port
                - 源端口
                    - 请求方的端口号
                - 长度:16 bit
            - Destination Port
                - 目的端口
                    - 响应方的端口号
                - 长度:16 bit
            - Sequence Number
                - 序列号
                    - 由报文发送方使用
                    - 表示在这个报文段中数据的第一个字节序号
                - 长度:32 bit
            - Acknowledgment Number
                - 确认号
                    - 仅当ACK置位时启用
                    - 由报文接收方返回给发送方的通知
                    - 表示期望收到报文段中数据的下一个字节序号
                    - 一般等于上次的Sequence Number+Data Length
                - 长度:32 bit
            - Data Offset
                - 数据偏移
                    - 表示数据分段在报文中的位置
                - 长度:4 bit
            - Reserved
                - 预留
                - 长度:6 bit
            - URG
                - 紧急指针位开关
                    - 置位时表示报文内有紧急数据,需尽快转发
                    - 同时启用Urgent Pointer(紧急指针)字段
                - 长度:1 bit
            - ACK
                - 确认位开关
                    - 置位时表示确认
                    - 同时启用Acknowledgment Number(确认号)字段
                - 长度:1 bit
            - PSH
                - 推送位开关
                    - 置位时表示尽快交付给接收应用,而不用继续等待缓存
                - 长度:1 bit
            - RST
                - 重置位开关
                    - 置位时表示连接重置,将立刻释放该TCP连接
                - 长度:1 bit
            - SYN
                - 握手位开关
                    - 置位时表示这是一个TCP三次握手的建立连接报文
                - 长度:1 bit
            - FIN
                - 完成位开关
                    - 置位时表示要求释放TCP连接
                - 长度:1 bit
            - Window Size
                - 窗口大小
                    - 表示准备接收的每个报文的最大上限
                - 长度:16 bit
            - Checksum
                - 校验序列
                    - 校验报文的有效性
                - 长度:16 bit
            - Urgent Pointer
                - 紧急指针
                    - 仅当URG置位时启用
                    - 表示报文中紧急数据的最后一个字节的序号
                - 长度:16 bit
            - Options
                - 可选信息
                - 长度:最多40 Byte
            - Padding
                - 填充信息
            - Data
                - 被TCP报文封装的数据
                - 包含应用层协议头部和用户数据
        - TCP可靠性机制
            - 确认机制
                - Seq=上一次的Ack
                - Ack=上一次的Seq+Length
                - 如果没有接收到,或接收的是不完整数据,会再次发送Ack请求对方重发
            - TCP连接的建立
                - 三次握手
                    - 第一次
                        - 请求方
                        - SYN置位
                    - 第二次
                        - 响应方
                        - SYN,ACK置位
                    - 第三次
                        - 请求方
                        - ACK置位
            - TCP连接的释放
                - 常规释放
                    - 四次挥手
                        - 第一次
                            - 请求方
                            - FIN置位
                        - 第二次
                            - 响应方
                            - ACK置位
                        - 第三次
                            - 响应方
                            - FIN置位
                        - 第四次
                            - 请求方
                            - ACK置位
                - 强制释放
                    - 第一次
                        - 任意方
                        - RST置位
                    - 此时将不再等待对方回包确认,直接释放TCP连接
            - 窗口机制
                - 滑动窗口
                    - 通过通告对方本机接收能力,来实现流量控制
            - 完整性校验
                - 通过Checksum来校验数据完整性
        - TCP特征
            - 优点
                - 可靠性高
            - 缺点
                - 占用带宽高,传输延迟高
        - TCP的适用场景
            - 对数据完整性要求高,但是对传输延迟要求低
    - UDP的原理
        - UDP头部封装格式
            - Source Port
                - 源端口
                    - 请求方端口
                - 长度:16 bit
            - Destination Port
                - 目的端口
                    - 响应方端口
                - 长度:16 bit
            - Length
                - 报文长度
                    - 表示整个报文的长度
                    - 包括头部与数据
                - 长度:16 bit
            - Checksum
                - 校验序列
                    - 校验报文的有效性
                - 长度:16 bit
            - Data
                - 数据
        - UDP特征
            - 优点
                - 占用带宽低,传输延迟低
            - 缺点
                - 没有任何可靠性机制
        - UDP的适用场景
            - 对传输延迟要求高,但数据完整性要求低
07. 命令行操作基础
    - H3C路由交换产品连接方法
        - 使用Console线本地连接
            - 协议Serial, 接口com口, 波特率9600
            - 适用于设备的初次调试
        - 使用Telnet远程访问
            - 适用于设备上架配置好后的维护管理
        - 使用SSH远程访问
            - 数据传输过程加密, 安全的远程访问
    - 命令行使用基础
        - 命令行视图
            - 用户视图
                - \<H3C\>
                - 标识为尖括号:<>
                - 只能查看配置, 不能修改配置
                - 新设备默认设备名为H3C
            - 系统视图
                - [H3C]
                - 标识为方括号:[]
                - 可以查看和修改全局配置
            - 接口视图
                - [H3C-GigabitEthernet0/0]
                - 可以对接口修改配置
        - 视图的切换
            - `system-view`
                - 用户视图进入系统视图命令
            - `interface g0/0`
                - 系统视图进入g0/0接口的接口视图
            - `quit`
                - 返回上层视图
            - `return`
                - 直接返回到用户视图
                - 快捷键 Ctrl+z
        - 常用查看命令
            - `display current-configuration`
                - 查看当前运行的所有配置
            - `display ip interface brief`
                - 查看所有三层接口的摘要信息
                - 接口的IP地址
                - 接口的连通状态
            - `display interface g0/0`
                - 查看g0/0接口的详细信息
            - `display version`
                - 查看设备硬件版本信息
            - `display this`
                - 查看当前视图下配置了哪些参数
        - 设备操作命令
            - `sysname R1`
                - 更改设备名称为R1
                - 系统视图
                - 命名规范
                    - 公司名\_机房所在城市名\_机房名\_机柜列\_机柜号\_从上往下数第几台机器
            - `reboot`
                - 重启设备
                - 用户视图
            - `save`
                - 保存当前配置
                - 系统视图
            - `reset saved-configuration`
                - 清空保存的配置
                    - 等同于恢复出厂设置
                    - 不会影响谁被的当前运行状态,重启后生效
                - 用户视图
            - `undo`
                - 在命令前加undo代表执行该命令的反向操作
            - `shutdown`
                - 手动关闭接口
                - 接口视图
            - `undo shutdown`
                - 手动开启接口
        - 命令行帮助
            - 命令简写
                - 可以只输入命令的前几个字母
                - 需要保证简写命令匹配正确命令的唯一性
            - ?键命令提示
            - tab键自动补齐命令
08. 网络设备文件管理
    - 设备存储器
        - ROM
            - 只读存储器,存储了Bootrom程序
                - 在Bootrom模式下可以破解密码
        - Flash
            - 闪存,永久存储操作系统文件,配置文件等数据
        - RAM
            - 当前配置内存,存储当前正在运行的数据,断电数据会丢失
    - 设备配置文件
        - 当前配置
            - current-configuration
            - 设备当前正在运行和生效的配置信息,存储在RAM中
        - 起始配置
            - startup-configuration
            - 每次设备开启会自动加载的配置信息,存储在Flash中
        - 起始配置文件备份
            - 通过USB或者FTP把startup.cfg和startup.mdb拷贝到其他存储
            - 配置还原后,需要通过`startup saved-configuration startup.cfg`命令来指定新的配置
09. 网络设备调试
    - Debug
        - 定义
            - 对网络设备所支持的绝大部分协议和功能,系统都提供了相应的调试功能,帮助用户对错误进行诊断和定位
            - 调试信息的输出由两个开关控制
                - 屏幕输出开关
                - 协议调试开关
        - 开启Debug命令
            - `terminal monitor`
            - `terminal debugging`
            - `debugging 协议类型`
        - 结束Debug命令
            - `undo debugging all`
            - 快捷键:Ctrl+o
10. 以太网交换机工作原理
    - 以太网
        - 定义
            - 传输标准Ethernet II类型帧网络
        - 特征
            - 多路访问
            - 广播式的网络
        - Mac地址
            - 每台网络设备生产时就写入的一个全球唯一的物理地址
            - 48位长度,16进制格式地址
            - 前24位为厂商标识,后24是设备标识
        - 以太网帧格式
            - 目的Mac地址
            - 源Mac地址
            - 服务和类型
            - DATA
            - 帧校验序列
    - 交换机
        - 定义
            - 工作在数据链路层,通过识别Mac地址来进行数据转发的设备
        - 交换机数据转发原理
            - Mac地址表
                - 记录交换机每个端口和所连接的设备的Mac地址的映射关系
                - 一个接口可以对应多个Mac地址
                - 一个Mac地址不能对应多个接口
                - 老化时间:300秒
                - Mac地址表存储在交换机RAM中
            - 工作机制
                - 交换机学习数据帧的源Mac地址,来获得端口和设备的Mac地址的映射关系,写入Mac地址表
                - 交换机检查数据帧的目的Mac地址,从Mac地址表中的映射关系来判断把数据帧从哪个端口发出
                - 交换机对于目的Mac地址不存在于Mac地址表中的数据帧进行广播处理
            - 数据帧的转发方式
                - 对于目的Mac地址已知的单播帧,交换机查询Mac地址表进行转发
                - 对于目的Mac地址未知的单播帧,交换机进行广播处理
                - 对于广播帧,交换机继续广播处理
        - 数据传输模式
            - 单播
                - 接收者是某一个设备
            - 广播
                - 接收者是多有其他设备
            - 组播
                - 接收者是某一部分设备
        - 广播域
            - 网络中所有能接收到同样广播消息的设备的集合
            - 默认情况下,交换机的所有端口属于同一个广播域
11. VLAN和Trunk
    - VLAN的定义
        - 虚拟局域网,用来在二层网络中隔离广播域
        - 不同VLAN的设备在二层网络中无法互相通讯
    - VLAN的转发过程举例
        - 1.PC发送数据帧进入交换机,会被打上VLAN Tag;VLAN Tag中的VLAN ID就是收到帧的接口所属VLAN;一旦数据帧被打上VLAN Tag,就变成了802.1Q格式帧
        - 2.交换机检查数据帧的目的Mac地址,进行判断;如果目的Mac地址对应的接口允许Tag中的VLAN ID通过,则数据帧可以转发;否则,丢弃该帧
        - 3.数据帧从接口发往PC前,会剥离VLAN Tag,使之还原为标准的以太网帧格式
    - 802.1Q
        - 在源Mac地址和Type之间携带VLAN Tag的帧格式,计算机不识别
    - VLAN工作原理
        - 交换机端口类型
            - Access
                - 必须加入到一个VLAN,只能加入到一个VLAN;从Access端口收到的帧,会打上该端口所属VLAN的Tag;从Access端口发出的帧会剥离Tag
                - 一般用来连接PC或路由器
                - H3C交换机默认所有端口都是Access类型属于VLAN 1;华为是Hybrid
            - Trunk
                - 可以允许多个VLAN的数据通过;从Trunk端口发出的帧保留VLAN Tag,但是缺省VLAN除外;Trunk端口收到未打Tag的帧,会重新打上缺省VLAN的Tag
                - 一般用来连接交换机
            - Hybrid
                - 可以允许多个VLAN的数据通过;可以手动配置从Hybrid端口发出的帧,哪个VLAN保留Tag,哪个VLAN剥离Tag;Hybrid收到未打Tag的帧,会重新打上缺省VLAN的Tag
                - 可以连接PC/路由器,也可以连接交换机
        - PVID
            - 定义
                - 表示某个端口的缺省VLAN
            - 特征
                - Access端口所属的VLAN就是PVID,不用配置,默认是VLAN 1
                - Trunk端口需要手动配置PVID,默认是VLAN 1
                - Hybrid端口需要手动配置PVID,默认是VLAN 1
    - VLAN类型
        - 基于端口的VLAN
            - 端口固定属于某个VLAN
        - 基于Mac地址的VLAN
            - Mac地址绑定到VLAN,同一Mac地址的设备,无论连接在哪个端口,VLAN归属不变
            - 端口类型需要配置为Hybrid
        - 基于协议的VLAN
            - 三层协议绑定到VLAN,同一协议的报文,无论从哪个端口接收,VLAN归属不变
            - 端口类型需要配置为Hybrid
        - 基于IP子网的VLAN
            - IP网段绑定到VLAN,同一IP子网的设备,无论连接在哪个端口,VLAN归属不变
            - 端口类型需要配置为Hybrid
        - VLAN归属优先级
            - Mac地址VLAN > IP子网VLAN > 协议VLAN > 端口VLAN
    - VLAN常用命令
        - 显示所有VLAN摘要信息
            - `display vlan brief`
            - 在用户视图输入命令
        - 创建VLAN
            - `vlan 10`
            - 在用户视图输入命令
            - 输入命令后会创建VLAN 10并进入VLAN 10视图
            - 将端口加入VLAN,有2个方法
                - VLAN视图输入命令
                    - `port g1/0/1`
                - 接口视图输入命令
                    - `port access vlan 10`
        - 创建Trunk
            - 先进入到需要创建Trunk的接口视图`int g1/0/3`
            - `port link-type trunk`
            - 默认Trunk只放行VLAN 1,需要配置白名单
            - 还是在刚才创建Trunk的接口视图
            - `port trunk permit vlan all`
            - 最后的all是放行所有VLAN
            - 要限定个别VLAN通过只需将all改为VLAN号就可以
            - 多个VLAN用空格隔开
            - 比如:`port trunk permit vlan 10 20 30`
12. 生成树协议
    - 二层环路带来的问题
        - 广播风暴
        - Mac地址表震荡
    - 生成树定义
        - STP,用来解决二层环路问题
    - STP相关概念
        - BPDU
            - 定义
                - 桥协议数据单元,用于传递STP协议相关报文
            - 分类
                - 配置BPDU
                    - 用于传递STP的配置信息
                - TCN BPDU
                    - 用于通告拓扑变更信息
    - STP的选举机制
        - 在所有交换机中选举出一台作为根交换机或叫做根网桥(Root bridge)
            - 选举规则
                - Bridge-ID小的优先
            - Bridge-ID
                - 定义
                    - 桥ID,BID,用来标识交换机的身份
                - 格式
                    - 优先级+Mac地址
                    - 优先级默认32768,必须是4096的倍数
        - 每台非根网桥(交换机)选举出一个根端口(Root port)
            - 选举规则
                - 1.到达根网桥开销小的优先
                - 2.对端交换机BID小的优先
                - 3.端口ID小的优先
            - 开销
                - Cost,代表路径耗费的代价和成本,带宽越大开销越小,带宽越小开销越大
        - 每个物理段上选举出一个指定端口(Designated port)
            -选举规则
                - 1.到达根网桥开销小的优先
                - 2.本机BID小的优先
                - 3.端口ID小的优先
        - 剩下没有角色的端口就是阻塞端口(Blocked port)
    - STP初始化流程
        - 交换机端口状态
            - disable:禁用状态,被关闭的端口
            - blocking:阻塞状态
                - 只接收BPDU,但不发送BPDU,不学习Mac地址,不转发数据
            - listening:监听状态
                - 接收并发送BPDU,不学习Mac地址,不转发数据,持续15秒
            - learning:学习状态
                - 接收并发送BPDU,学习Mac地址,不转发数据,持续15秒
            - forwarding:转发状态
                - 接收并发送BPDU,学习Mac地址,转发数据
    - STP计时器
        - Hello time
            - 2秒
            - 配置BPDU的发送周期
        - Max age
            - 20秒
            - 判断链路故障的时间,10个Hello time周期
        - Forwarding delay
            - 15秒
            - 状态切换延迟
    - STP拓扑变更机制
        - 1.Max age超时/有接口变更为转发状态,判断为拓扑发生变更,向根网桥发起TCN BPDU
        - 2.收到TCN BPDU的交换机继续向根网桥转发TCN BPDU,到达根网桥为止
        - 3.根网桥收到TCN BPDU后,向所有端口发起TC置位的配置BPDU
        - 4.交换机收到TC置位的配置BPDU后,Mac地址表的老化时间缩短到15秒
    - STP的问题
        - 收敛速度慢,故障切换时间太长
        - 网络中大量主机频繁上下线,会导致TCN BPDU大量发送
    - RSTP
        - 快速生成树协议
            - 端口状态减少到3种
            - 端口角色增加到4种
                - 根端口和指定端口不变
                - 阻塞端口细分为2种
                    - 替代端口(Alternata port)
                        - 根端口的备份
                    - 备份端口(Backup port)
                        - 指定端口的备份
            - 边缘端口机制
                - 当链路激活,边缘端口立即进入转发状态,不参与STP计算
                - 边缘端口UP/DOWN不会触发拓扑变更
                - 建议把连接PC的端口配置为边缘端口
    - MSTP
        - 多生成树协议
            - 将多个VLAN捆绑到一个生成树实例,每个实例分别独立计算生成树
            - 基于STP计算结果不同,实现不同VLAN的流量负载均衡
    - STP常用命令
        - [h3c]`display stp`
            - 查看STP相关信息
        - [h3c]`display stp brief`
            - 查看STP端口状态
        - [h3c]`stp global enable`
            - 全局启用STP
        - [h3c-GigabitEthernet 1/0/1]`undo stp enable`
            - 关闭端口上的STP
        - [h3c]`stp mode 'stp/rstp/mstp'`
            - 更改STP模式,默认模式是mstp
        - [h3c]`stp priority 'priority'`
            - 更改交换机优先级
        - [h3c-GigabitEthernet 1/0/1]`stop cost 'cost'`
            - 更改接口生成树的cost
        - [h3c-GigabitEthernet 1/0/1]`stp edged-port`
            - 配置端口为边缘端口
13. 交换机端口安全技术
    - 802.1X
        - 定义
            - 起源于WLAN协议802.11,解决局域网终端的接入认证问题
        - 认证方式
            - 本地认证
            - 远程集中认证
        - 端口接入控制方式
            - 基于端口认证
            - 基于Mac地址认证
    - 端口隔离技术
        - 用于在同VLAN内部隔离用户
        - 同一隔离组端口不能通讯,不同隔离组端口可以通讯
14. 链路聚合
    - 定义
        - 把连接到同一台交换机上的多个物理端口捆绑为一个逻辑端口
    - 功能
        - 提高链路可靠性
            - 聚合组内只要还有物理端口存活,链路就不会中断
        - 增加链路传输带宽
            - 避免了STP计算,聚合组内物理端口不会被阻塞
            - 交换机之间的流量会自动在聚合组内的所有物理端口上负载分担
    - 负载分担
        - 也称负载均衡
        - 聚合后的链路会基于流自动负载分担
    - 分类
        - 静态聚合
            - 双方不会协商聚合参数
        - 动态聚合
            - 双方通过LACP协议协商聚合参数
    - 常用命令
        - [h3c]`interface bridge-aggregation 'number'`
            - 创建链路聚合逻辑口并给与编号
        - [h3c-GigabitEthernet 1/0/1]`port link-aggregation group 'number'`
            - 将g1/0/1端口加入链路聚合逻辑口
        - [h3c]`display link-aggreagation summary`
            - 查看链路聚合逻辑口信息
15. IP子网划分
    - 子网掩码
        - 产生背景
            - 通过自然分类来划分网络规模会造成大量IP地址浪费
            - IPv4地址资源已经全部耗尽
        - 定义
            - 由连续的1或0组成的32位掩码,用来衡量IP地址网络位的长度
            - 连续的1对应的部分位网络位
            - 连续的0对应的部分为主机位
        - 分类
            - 主类掩码
                - 和自然分类一致的子网掩码
            - VLSM
                - 可变长子网掩码
                - 通过把子网掩码变长来把一个网段划分为多个子网
            - CIDR
                - 无类域间路由
                - 通过把子网掩码缩短来把多个网段聚合为一个网段
    - VLSM算法
        - 1.得出下列参数
            - 借位数
                - 从自然网段计算把几个0变成了1
            - 剩余位数
                - 网段一共还剩余几个0
            - 借位段剩余位数
                - 仅A类B类自然网段使用
                - 借位段还剩余几个0
        - 2.计算划分结果
            - 划分出的子网数量:`2^借位数`
            - 每个子网可用的IP数量:`2^剩余位数`-`2`
            - 每两个子网的间隔位数:`2^借位段剩余位数`
                - 仅A类B类自然网段使用
        - 3.列出每个子网
            - C类地址
                - `第一段子网网段`=`起始网段`
                    - `第一段子网首位`=`第一段子网网段`+`1`
                    - `第一段子网末位`=`第一段子网首位`+`每个子网可用的IP数量`-`1`
                    - `第一段子网的广播位`=`第一段子网末位`+`1`
                - `第N段子网网段`=`上一段子网广播位`+`1`
                    - `第N段子网首位`=`第N段子网网段`+`1`
                    - `第N段子网末位`=`第N段子网首位`+`每个子网可用的IP数量`-`1`
                    - `第N段子网的广播位`=`第N段子网末位`+`1`
            - B类和A类地址
                - 先划分出大的子网段
                - `第一段子网网段`=`起始网段`
                - `第N段子网网段`=`上一段子网网段的借位段`+`每两个子网的间隔位数`
                    - `第N段子网的广播位`=`下一段子网网段`-`1`
                    - `第N段子网的末位`=`第N段子网的广播位`-`1`
                    - `第N段子网的首位`=`第N段子网网段`+`1`
        - 举例1:C类地址
            - 192.168.1.0/26
            - 1.得出下列参数
                - 借位数:2
                - 剩余位数:6
            - 2.计算划分结果
                - 划分出的子网数量:2^借位数=4
                - 每个子网可用IP数量:2^剩余位数-2=62
            - 3.列出每个子网:
                - 192.168.1.0/26
                    - 192.168.1.1-192.168.1.62
                    - 广播地址:192.168.1.63
                - 192.168.1.64/26
                    - 192.168.1.65-192.168.1.126
                    - 广播地址:192.168.1.127
                - 192.168.1.128/26
                    - 192.168.1.129-192.168.1.190
                    - 广播地址:192.168.1.191
                - 192.168.1.192/26
                    - 192.168.1.193-192.168.1.254
                    - 广播地址:192.168.1.255
        - 举例2:B类地址
            - 172.16.0.0/18
            - 1.得出下列参数
                - 借位数:2
                - 剩余位数:14
                - 借位段剩余位数:6
            - 2.计算划分结果
                - 划分出的子网数量:2^借位数=4
                - 每个子网可用IP数量:2^剩余位数-2=16382
                - 每两个子网的间隔位数:2^借位段剩余位数=64
            - 3.列出每个子网:
                - 172.16.0.0/18
                    - 172.16.0.1-172.16.63.254
                    - 广播地址:172.16.63.255
                - 172.16.64.0/18
                    - 172.16.64.1-172.16.127.254
                    - 广播地址:172.16.127.255
                - 172.16.128.0/18
                    - 172.16.128.1-172.16.191.254
                    - 广播地址:172.16.191.255
                - 172.16.192.0/18
                    - 172.16.192.1-172.16.255.254
                    - 广播地址:172.16.255.255
        - 举例3:A类地址
            - 100.0.0.0/11
            - 1.得出下列参数
                - 借位数:3
                - 剩余位数:21
                - 借位段剩余位数:5
            - 2.计算划分结果
                - 划分出的子网数量:2^借位数=8
                - 每个子网可用IP数量:2^剩余位数-2=2097150
                - 每两个子网的间隔位数:2^借位段剩余位数=32
            - 3.列出每个子网:
                - 100.0.0.0/11
                    - 100.0.0.1-100.31.255.254
                    - 广播地址:100.31.255.255
                - 100.32.0.0/11
                    - 100.32.0.1-100.63.255.254
                    - 广播地址:100.63.255.255
                - 100.64.0.0/11
                    - 100.64.0.1-100.95.255.254
                    - 广播地址:100.95.255.255
                - 100.96.0.0/11
                    - 100.96.0.1-100.127.255.254
                    - 广播地址:100.127.255.255
                - 100.128.0.0/11
                    - 100.128.0.1-100.159.255.254
                    - 广播地址:100.159.255.255
                - 100.160.0.0/11
                    - 100.160.0.1-100.191.255.254
                    - 广播地址:100.191.255.255
                - 100.192.0.0/11
                    - 100.192.0.1-100.223.255.254
                    - 广播地址:100.223.255.255
                - 100.224.0.0/11
                    - 100.224.0.1-100.255.255.254
                    - 广播地址:100.255.255.255
    - 常见子网划分对应关系
        - 25
            - 255.255.255.128
            - 126个可用地址
        - 26
            - 255.255.255.192
            - 62个可用地址
        - 27
            - 255.255.255.224
            - 30个可用地址
        - 28
            - 255.255.255.240
            - 14个可用地址
        - 29
            - 255.255.255.248
            - 6个可用地址
        - 30
            - 255.255.255.252
            - 2个可用地址
        - 31
            - 255.255.255.254
            - 2个可用地址
                - PPP链路(点到点链路)可用
        - 32
            - 255.255.255.255
            - 1个可用地址
                - 设备的Loopback接口可用
16. DNS
    - 域名
        - 产生背景
            - 通过IP地址访问目标主机,不便于记忆
            - 通过容易记忆的域名来标识主机位置
        - 域名的树型层次化结构
            - 根域
            - 顶级域
                - 主机所处的国家/区域,注册人的性质
            - 二级域
                - 注册人自行创建的名称
            - 主机名
                - 区域内部的主机名称
    - 定义
        - 用于域名和IP地址的互相解析
    - DNS查询模式
        - 递归查询
            - DNS服务器一定会返回一个确切的查询结果
            - 客户端到DNS服务器的查询
        - 迭代查询
            - DNS服务器会返回一个已知的其他DNS服务器,由请求者自行查询
            - DNS服务器到DNS服务器的查询
    - H3C配置DNS代理
        - [h3c]`dns proxy enable`
        - [h3c]`dns server '公网DNS地址'`
        - 内网终端DNS服务器指向为本路由器
17. 文件传输协议
    - FTP
        - 定义
            - 文件传输协议
            - 客户端/服务器模式,又称C/S模式,具备身份验证功能
            - 双TCP连接
        - 端口
            - 控制连接:21
                - 用于传输FTP命令和执行信息
            - 数据连接:20
                - 用于数据上传,下载
        - 数据传输方式
            - 主动方式
                - 数据连接由服务器主动发起
                - 控制连接:21端口
                - 数据连接:20端口
            - 被动方式
                - 数据连接由客户端主动发起
                - 控制连接:21端口
                - 数据连接:服务器随机产生端口
    - TFTP
        - 简单文件传输协议
        - 基于UDP,69号端口
        - 只有数据传输功能,不提供身份验证,目录列表等功能
    - 常用命令
        - [h3c]`ftp server enable`
            - 开启FTP服务
        - \<h3c\>`ftp 'ip address'`
            - 连接FTP服务器
        - ftp>`ls`
            - 列出当前目录
        - ftp>`get 'file name'`
            - 下载文件
        - ftp>`put 'file name'`
            - 上传文件
        - ftp>`bye`
            - 断开FTP连接
18. DHCP
    - 产生背景
        - 局域网中手动配置静态IP地址任务繁琐,而且容易出错
    - 定义
        - 动态主机配置协议
        - 用于为局域网中主机动态分配IP地址及相关信息
        - 采用客户端/服务器模式,又称C/S模式
        - 服务端端口:UDP 67
        - 客户端端口:UDP 68
    - 工作原理
        - 分配IP地址工作流程
            - 1.客户端以全网广播形式发起IP地址寻找
            - 2.服务器以全网广播形式向客户端发送IP地址提供
            - 3.客户端选择好IP地址后,以全网广播形式向服务器请求选择结果
            - 4.服务器向客户端以全网广播形式发送IP地址确认
        - 特殊情况的处理
            - 当网络中存在多台DHCP服务器,客户端会优先选择最先到达的IP地址提供
        - IP地址租约更新
            - 租期到达50%,客户端如在线,会向服务器发起租约更新请求
            - 租期到达87.5%,客户端如在线,会向服务器发起租约更新请求
    - DHCP中继代理
        - 用于跨网段分配IP地址
        - IP地址请求的相关报文都是广播发送,无法跨越网段,所以需要在中间路由器开启DHCP中继代理功能
    - 相关命令
        - [h3c]`dhcp enable`
            - 开启DHCP服务
        - [h3c]`dhcp server ip-pool 'name'`
            - 创建DHCP地址池并命名
        - [h3c-dhcp-pool1]`network 'network' mask 'mask'`
            - 配置用于分配的地址范围,network填网段,mask填子网掩码
        - [h3c-dhcp-pool1]`gateway-list 'ip address'`
            - 配置用于分配的网关地址
        - [h3c-dhcp-pool1]`dns-list 'ip address'`
            - 配置用于分配的DNS服务器地址
        - [h3c-dhcp-pool1]`expired`
            - 配置DHCP租期
        - [h3c]`dhcp server forbidden-ip 'start ip address' 'end ip address'`
            - 配置不参与分配的IP地址
        - [h3c-GigabitEthernet 0/0]`dhcp select relay`
            - 接口上开启DHCP中继功能
        - [h3c-GigabitEthernet 0/0]`dhcp relay server-address 'ip address'`
            - 指定用于中继的DHCP服务器IP地址
        - [h3c]`display dhcp server statistics`
            - 查看DHCP服务器统计信息
19. IPv6基础
20. IP路由原理
21. VLAN间路由
22. 静态路由
23. 路由协议概述
24. RIP

---
<p align="right"><a href=".\README.md">返回总目录</a></p>
